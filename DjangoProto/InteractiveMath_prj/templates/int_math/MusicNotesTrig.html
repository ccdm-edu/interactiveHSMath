{% extends 'int_math/baseTrig.html' %}
{% load static %} <!--  another difference from django 2 to 3.1 -->

{%block title_block %}
	{{ page_tab_header }}
{% endblock %}
 
{%block head_block %}
    <link href="{%static 'css/MusicNotesTrig.css' %}" rel="stylesheet">
{% endblock %}
   
{% block body_block %}

<!-- SineCosID is a placemarker for begin of link to go to sine cosine tones and musical notes -->
<div id="SineCosBlock">
	
	<div id ="headerAndCtl_TT">
    	<h1 id = "musicalActivity"></h1>
    </div>
    <!-- default startup, will change as user loads musician notes-->
    <p class="AdvTopic_ToDo"> TRY THIS:  Turn on your speaker.  Select an instrument from the drop down menu.  Hit Play Tone button to hear the sine wave frequency of this note (to within 1 Hz) then hit Start Instrument button.
    Look at the plot of the MP3 waveform of the musician playing the note versus the sine wave basic frequency.  The period of the two waveforms are the same.  The musicians sound is much richer than the sine
    wave at the pitch frequency, which you would expect by looking at the more complex waveform produced.
	</p>
    <p class="AdvTopic_Expln"> EXPLANATION:  Sine and Cosine functions, when translated to voltage and sent to a speaker are just tones.  Here we set the frequencies to the pitch frequency of the instrument/note played. 
    Musical notes are made up of a pitch frequency, which is the sine wave tone shown here plus some harmonics of the pitch frequency and overtones that give the instrument its richness.  
    The harmonics and overtones are multiples of the pitch frequency which is why the musical instrument playing a note repeats at the rate of the sine wave pitch frequency.  
    In fact, we could start with a sine at the pitch frequency and a calculated amplitude and phase.  Then we add another sine at 2 times the pitch frequency with newly calculated amplitude and phase.  
    We continue and add another sine and cosine of 3x the pitch frequency with calculated amplitude and phase and so on up to a very high multiple of the pitch frequency.  This is how you can mathematically represent ANY of these
    musical instruments playing a note.  The amplitudes calculated would be different for a trumpet versus a flute versus the human voice but you could create any of these
    waveforms of an instrument playing a note. This is the basis for Fourier Series, a college concept for mathematically representing ANY periodic waveform.  The concept is used in musical digital synthesizers to generate a wide variety of sounds.
    </p>  
    
	<!--  dont put tables inside a div, they stop "working", elements aren't functional anymore -->
	<div id="MusicNotesToneControl">
	
		<div id="musicNotes">
			<table>
				<tbody>
					<tr>
						<th colspan='2'>Musical Notes Parameters</th>
					    <!-- this only shows up when musical instrument selected, put next to start/stop tone -->
						<input type="button" id="allowNotePlay" > 
					</tr>	
					<tr>		
						<td align="left">
							<label for="InstrumentTypes">Choose a musical instrument:</label>
							<select name="InstrumentTypes" id="InstrumentTypes">
								<option value="-1">Select Here</option>
								<!-- subscripts/superscripts dont work on drop down menus ??? -->
								<option value="0">B<sup>&#9837;</sup> Trumpet</option>
								<option value="1">Clarinet</option>
								<option value="2">Soprano Sax</option>
								<option value="3">Tenor Sax</option>
								<option value="4">Flute</option>
								<option value="5">Human voice</option>
							</select>
						</td>
						<td align="right">
							Volume: <span id="currMusicVolLabel"></span>
						</td>						
					</tr>
					<tr>
						<td align="left">
							Current Note: <span id="currMusicNoteLabel"></span>
						</td>
						<!-- vertical orientation not supported the same way by all browsers and likely to change, keep horiz, use bootstrap for tooltips  -->
						<td align="right">
							<input id="music-amp" type="range" step="1" value="3" min="0" max="10" data-toggle="tooltip" data-placement="left" title="We'll leave graph the same for simplicity">
						</td>
					</tr>
				</tbody>
			</table>
		</div>

		<div id="toneChanges">
			<table>
				<tbody>
					<tr>
						<th colspan='2'>Sine Wave (tone) Parameters</th>
 								<!--  this button plays the tone and is visible all the time -->
						<input type="button" id="toneStartButton" value="Play Tone" data-toggle="tooltip" data-placement="top" title="turn on speaker to hear sine wave you created">
					</tr>	
					<tr>		
						<td>
							Frequency: <span id="currFreqLabel"></span> Hz
						</td>
						<td>
							Volume: <span id="currToneVolLabel"></span>
						</td>						
					</tr>
					<tr>
						<!-- vertical orientation not supported the same way by all browsers and likely to change, keep horiz, use bootstrap for tooltips  -->
						<td>  <!-- placeholder for missing element -->
						     
						</td>
						<td align="right">
							<input id="tone-amp" type="range" step="1" value="3" min="0" max="10" data-toggle="tooltip" data-placement="left" title="We'll leave graph the same for simplicity">
						</td>
					</tr>
				</tbody>
			</table>
		</div>

	</div>
	
 	<div id="GraphPlusPeriodMarkers">
 		<!--  want to overlap the top graph with expansion lines below it -->
 		<!--  canvas used for chart js need the size defined one level up at div -->
	 	<div id = "sinePlotLongWrapper">
	 		<!-- Needs to be a bit bigger since it has the title -->
	 		<canvas id="sine_plotsLong">
	 		Your Browser does not support canvas tag, you are missing graph capability
	 		</canvas>
	 	</div>
	 	<div class="Period_Tone First_Period"></div>
	 	<div class="Period_Tone Second_Period"></div>
	 	<div class="Period_Tone Third_Period"></div>
	 	<div class="Period_Tone Fourth_Period"></div>
	 	<div id = "Period_Text1" ></div>
	 	<div id = "Period_Text2" ></div>
	 	
	 	<!-- Needed for the period markers showing periodicity -->
	 	<!--  use following for debug on canvas placement  style="border:1px solid #FF0000; to see the canvas in red -->
		<canvas id="timeExpand">
 			Your Browser does not support canvas tag, you are missing graph capability
 		</canvas>
 	</div>
	
	<!-- Put up a brief "HOW TO use this page" modal window -->
	<div class="modal fade" id="admodal" role="dialog" tabindex="-1">
		<div class="modal-dialog" role="document">
			<div class="modal-content">
				<div class="modal-body">
					<h1>What to do here</h1>
					<ul>
					<li>Select a musical instrument playing a note by <b>clicking on the pull down menu.</b>  
				    <li>Play the pitch note for this instrument by <b>hitting Play Tone green button</b> in upper right.  I will set up the correct pitch frequency for you for the note played.</li>
				    <li>Compare the pitch note to the instrument playing that note by 
				  		<b>hitting Play Instrument green button </b> on upper left.</li>	
				    <li>Compare the plot of the sine wave at pitch frequency with the instrument playing that note.  Notice they both repeat at the same period.</li>
				    <li>Why is the period of the instrument extremely close but not exactly the same as the sine wave?  Check Advanced(popup) link to find out why </li>				
					</ul>
				</div>
				<div class="modal-footer">
					<!--  when clicked, this will dismiss the modal -->
					<button class="btn btn-success" data-dismiss="modal" type="button">Got it!</button><br class="visible-xs">	
				</div>
			</div><!-- /.modal-content -->
		</div><!-- /.modal-dialog -->
	</div><!-- /.modal -->

	
	<script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.73/Tone.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.min.js"></script>
        
	<!--  this must come before the jquery ui and bootstrap-->	
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

	<script>
			<!-- in case can't get from google, load from local -->
			var localJQ = "{% static 'js/jquery-360min.js' %}";
			window.jQuery || document.write('<script src="${localJQ}"><\/script>')
	</script>
	<!--  jquery ui needed for advanced topic draggable window -->
	<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.13.2/jquery-ui.min.js"></script>
	<script src="https://getbootstrap.com/docs/4.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-zDnhMsjVZfS3hiP7oCBRmfjkQC4fzxVxFhBx8Hkz2aZX8gEvA/jsP3eXRCvzTofP" crossorigin="anonymous"></script>
			
	<script src="https://cdnjs.cloudflare.com/ajax/libs/feather-icons/4.9.0/feather.min.js"></script>
	<!-- The feather.replace() causes all data-feather to be replaced with proper svg icon -->
	<script>feather.replace()</script>
			
	<!-- To be able to add modal window for robot check -->
	<script src="{% static 'js/jquery-bootstrap-modal-forms-min.js' %}" crossorigin="anonymous"></script>
	
	<!-- Custom JS for this page -->
	<script src="{% static 'js/IntMath.js' %}" crossorigin="anonymous"></script>	
	<script src="{% static 'js/IntMathUtils.js' %}" crossorigin="anonymous"></script>	
	<script src="{% static 'js/autoDemo.js' %}" crossorigin="anonymous"></script>	    
    <script src="{% static 'js/MusicNotesTrig.js' %}" crossorigin="anonymous"></script>	 

</div>
{% endblock %}